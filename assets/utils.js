export const debounce=(e,t)=>{let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e.apply(this,r),t)}};export const nextFrame=e=>requestAnimationFrame(e);export const frameSequence=(e,t)=>{nextFrame(()=>{const n=e();nextFrame(()=>t(n))})};export const requestIdle=(e,t={})=>{if("requestIdleCallback"in window)return requestIdleCallback(e,t);const n=t.timeout||100,r=Date.now();return setTimeout(()=>{e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-r))})},n)};export const resizeObserver=(e,t={})=>{const n={debounceTime:150,element:null,width:!0,...t};let r=null,o=window.innerWidth;const s=t=>nextFrame(()=>e(t)),i=n.debounceTime>0?debounce(s,n.debounceTime):s,c=e=>{(()=>{if(!n.width)return!1;const e=window.innerWidth;return e===o||(o=e,!1)})()||i(e)},u=(e=n.element)=>r||(r=new ResizeObserver(c),e?r.observe(e):r.observe(document.documentElement),r);return{init:u,destroy:()=>{r?.disconnect(),r=null},observe:e=>{r||u(),r?.observe(e)},unobserve:e=>{r?.unobserve(e)},get observer(){return r}}};export const cleanupSystem=()=>{const e=new Map;return{register:(t,n)=>{if("function"==typeof n)if(e.set(t,n),window.themeCleanup){const e=window.themeCleanup;window.themeCleanup=()=>{n(),e()}}else window[`cleanup${t}`]=n;else console.warn(`Cleanup function for "${t}" is not a function`)},cleanup:t=>{const n=e.get(t);n&&(n(),e.delete(t))},cleanupAll:()=>{e.forEach((e,t)=>{try{e()}catch(e){console.warn(`Error cleaning up "${t}":`,e)}}),e.clear()},get registered(){return Array.from(e.keys())}}};export const onReady=e=>{"complete"===document.readyState?requestIdle(e):document.addEventListener("readystatechange",t=>{"complete"===t.target.readyState&&requestIdle(e)},{once:!0})};export const setCssVar=(e,t,n=document.documentElement)=>{n.style.setProperty(e,t)};export const getCssVar=(e,t=document.documentElement)=>getComputedStyle(t).getPropertyValue(e).trim();export const getDimensions=e=>{if(!e)return{width:0,height:0};const t=e.getBoundingClientRect();return{width:t.width,height:t.height}};