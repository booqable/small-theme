import{frameSequence as t,cleanupSystem as n}from"utils.js";const e={t:{container:".search",form:"#search",input:".search__input",opener:"#header-opener-search",reset:".search__reset"},u:{o:"filled"},attributes:{action:"action"},i:{query:"q"},l:50},r=()=>{const t=new Map;return{init:()=>(t.set("container",document.querySelector(e.t.container)),t.set("form",document.querySelector(e.t.form)),t.set("input",document.querySelector(e.t.input)),t.set("opener",document.querySelector(e.t.opener)),t.set("reset",document.querySelector(e.t.reset)),t.get("form")&&t.get("input")),get:n=>t.get(n),p:()=>{t.clear()}}},u=()=>{let t=null;return{init:()=>{try{return t=new URL(window.location.href),!0}catch(t){return!1}},getQuery:()=>t?t.searchParams.get(e.i.query):null,m:(n,r)=>{if(!t||!r)return"";const u=r.getAttribute(e.attributes.action);if("string"!=typeof u)return"";try{const r=new URL(t.origin+u);return r.searchParams.set(e.i.query,n),r.href}catch(t){return""}}}},o=n=>{const r=()=>{const r=n.get("input");r?.parentElement&&t(()=>({parent:r.parentElement,h:0!==r.value.length}),t=>{t.parent.classList.toggle(e.u.o,t.h)})};return{I:r,_:()=>{const e=n.get("input");e&&t(()=>({input:e}),t=>{t.input.value="",t.input.focus(),r()})},q:()=>{const u=n.get("input");if(!u)return;const o=()=>({input:u}),c=t=>{t?.input&&(t.input.focus(),r())};setTimeout(()=>{t(o,c)},e.l)},S:e=>{const u=n.get("input");u&&"string"==typeof e&&t(()=>({input:u,query:e}),t=>{t?.input&&"string"==typeof t.query&&(t.input.value=t.query,r())})}}},c=(t,n,e)=>({U:n=>{const r=n?.target;r===t.get("opener")&&e.q()},k:n=>{const r=n?.target;r===t.get("reset")&&(n.preventDefault(),e._())},v:()=>{e.I()},C:e=>{const r=e.target;if(r!==t.get("form"))return;e.preventDefault();const u=t.get("input");if(!u||"string"!=typeof u.value)return;const o=u.value.trim();if(!o)return;const c=n.m(o,r);c.length&&(window.location.href=c)}}),i=t=>{const n=[],e=(t,e,r,u={})=>{t.addEventListener(e,r,u),n.push({element:t,event:e,F:r})};return{init:()=>{e(document,"click",t.U),e(document,"click",t.k),e(document,"input",t.v),e(document,"submit",t.C)},destroy:()=>{n.forEach(({element:t,event:n,F:e})=>{t.removeEventListener(n,e)}),n.length=0}}},s=()=>{const t=r(),n=u();let e=null,s=null,l=null;const a=()=>{l?.destroy(),t?.p(),e=null,s=null,l=null};return{init:()=>{if(!t.init())return null;if(!n.init())return null;e=o(t),s=c(t,n,e),l=i(s);const r=n.getQuery();return r&&e.S(r),l.init(),a},destroy:a}},l=()=>{const t=n(),e=s().init();e&&t.register("Search",e)};l();