(()=>{var h=e=>requestAnimationFrame(e),d=(e,s)=>{h(()=>{let r=e();h(()=>s(r))})};var g=()=>{let e=new Map;return{register:(c,t)=>{if(typeof t=="function")if(e.set(c,t),window.themeCleanup){let o=window.themeCleanup;window.themeCleanup=()=>{t(),o()}}else window[`cleanup${c}`]=t},cleanup:c=>{let t=e.get(c);t&&(t(),e.delete(c))},cleanupAll:()=>{e.forEach((c,t)=>{try{c()}catch{}}),e.clear()},get registered(){return Array.from(e.keys())}}};var u={selectors:{container:".search",form:"#search",input:".search__input",opener:"#header-opener-search",reset:".search__reset"},classes:{filled:"filled"},attributes:{action:"action"},params:{query:"q"},focusDelay:50},m=()=>{let e=new Map;return{init:()=>(e.set("container",document.querySelector(u.selectors.container)),e.set("form",document.querySelector(u.selectors.form)),e.set("input",document.querySelector(u.selectors.input)),e.set("opener",document.querySelector(u.selectors.opener)),e.set("reset",document.querySelector(u.selectors.reset)),e.get("form")&&e.get("input")),get:c=>e.get(c),cleanup:()=>{e.clear()}}},w=()=>{let e=null;return{init:()=>{try{return e=new URL(window.location.href),!0}catch{return!1}},getQuery:()=>e?e.searchParams.get(u.params.query):null,buildSearchUrl:(c,t)=>{if(!e||!t)return"";let o=t.getAttribute(u.attributes.action);if(typeof o!="string")return"";try{let n=new URL(e.origin+o);return n.searchParams.set(u.params.query,c),n.href}catch{return""}}}},y=e=>{let s=()=>{let t=e.get("input");if(!t?.parentElement)return;d(()=>({parent:t.parentElement,expose:t.value.length!==0}),i=>{i.parent.classList.toggle(u.classes.filled,i.expose)})};return{updateClearButton:s,clearInput:()=>{let t=e.get("input");if(!t)return;d(()=>({input:t}),i=>{i.input.value="",i.input.focus(),s()})},focusInput:()=>{let t=e.get("input");if(!t)return;let o=()=>({input:t}),n=i=>{i?.input&&(i.input.focus(),s())};setTimeout(()=>{d(o,n)},u.focusDelay)},autoFillInput:t=>{let o=e.get("input");if(!o||typeof t!="string")return;d(()=>({input:o,query:t}),a=>{!a?.input||typeof a.query!="string"||(a.input.value=a.query,s())})}}},b=(e,s,r)=>({handleFocus:n=>{n?.target===e.get("opener")&&r.focusInput()},handleClear:n=>{n?.target===e.get("reset")&&(n.preventDefault(),r.clearInput())},handleInput:()=>{r.updateClearButton()},handleSubmit:n=>{let i=n.target;if(i!==e.get("form"))return;n.preventDefault();let a=e.get("input");if(!a||typeof a.value!="string")return;let p=a.value.trim();if(!p)return;let f=s.buildSearchUrl(p,i);f.length&&(window.location.href=f)}}),v=e=>{let s=[],r=(t,o,n,i={})=>{t.addEventListener(o,n,i),s.push({element:t,event:o,handler:n})};return{init:()=>{r(document,"click",e.handleFocus),r(document,"click",e.handleClear),r(document,"input",e.handleInput),r(document,"submit",e.handleSubmit)},destroy:()=>{s.forEach(({element:t,event:o,handler:n})=>{t.removeEventListener(o,n)}),s.length=0}}},S=()=>{let e=m(),s=w(),r=null,l=null,c=null,t=()=>{if(!e.init()||!s.init())return null;r=y(e),l=b(e,s,r),c=v(l);let n=s.getQuery();return n&&r.autoFillInput(n),c.init(),o},o=()=>{c?.destroy(),e?.cleanup(),r=null,l=null,c=null};return{init:t,destroy:o}},C=()=>{let e=g(),r=S().init();r&&e.register("SearchAPI",r)};C();})();
