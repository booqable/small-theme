import{frameSequence as t,cleanupSystem as e,intersectionObserver as n,inViewport as a}from"utils.js";const o={t:{image:".focal-image"},o:{l:"data-focal-x",u:"data-focal-y",i:"data-focal-processed"},m:"50% 50%"},r=()=>{const t=new Map,e=new Map;return{init:()=>{const e=document.querySelectorAll(o.t.image);return t.set("images",Array.from(e)),t.get("images").length>0},get:e=>t.get(e),p:t=>e.get(t),$:(t,n)=>{e.set(t,n)},h:()=>{t.clear(),e.clear()}}},l=t=>{const e=t=>{const e=50*((parseFloat(t)||0)+1);return`${Math.max(0,Math.min(100,e))}%`};return{M:(n,a)=>{if(null===n||null===a)return o.m;const r=`${n}_${a}`;let l=t.p(r);return l||(l=`${e(n)} ${e(a)}`,t.$(r,l)),l}}},c=e=>({P:n=>{if("true"===n.getAttribute(o.o.i))return;const a=n.getAttribute(o.o.l),r=n.getAttribute(o.o.u);if(null===a||null===r)return;const l=e.M(a,r);t(()=>({image:n,position:l}),t=>{t.image.style.objectPosition=t.position,t.image.style.opacity="1",t.image.setAttribute(o.o.i,"true")})}}),s=()=>{const t=r();let e=null;const o=()=>{e?.destroy(),t?.h(),e=null};return{init:()=>{if(!t.init())return null;const r=l(t),s=c(r);return e=n(t=>{t.forEach(t=>{t.isIntersecting&&(s.P(t.target),e.unobserve(t.target))})}),e.init(),t.get("images").forEach(t=>{a(t)?s.P(t):e.observe(t)}),o}}},u=()=>{const t=e(),n=s().init();n&&t.register("FocalImageAPI",n)};u();