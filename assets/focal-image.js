(()=>{var u=e=>requestAnimationFrame(e),d=(e,r)=>{u(()=>{let o=e();u(()=>r(o))})};var p=()=>{let e=new Map;return{register:(t,n)=>{if(typeof n=="function")if(e.set(t,n),window.themeCleanup){let s=window.themeCleanup;window.themeCleanup=()=>{n(),s()}}else window[`cleanup${t}`]=n},cleanup:t=>{let n=e.get(t);n&&(n(),e.delete(t))},cleanupAll:()=>{e.forEach((t,n)=>{try{t()}catch{}}),e.clear()},get registered(){return Array.from(e.keys())}}};var l={selectors:{image:".focal-image"},attr:{focalX:"data-focal-x",focalY:"data-focal-y",processed:"data-focal-processed"},defaultPosition:"50% 50%"},m=()=>{let e=new Map,r=new Map;return{init:()=>{let i=document.querySelectorAll(l.selectors.image);return e.set("images",Array.from(i)),e.get("images").length>0},get:i=>e.get(i),getCache:i=>r.get(i),setCache:(i,a)=>{r.set(i,a)},cleanup:()=>{e.clear(),r.clear()}}},g=e=>{let r=c=>{let n=((parseFloat(c)||0)+1)*50;return`${Math.max(0,Math.min(100,n))}%`};return{calculatePosition:(c,t)=>{if(c===null||t===null)return l.defaultPosition;let n=`${c}_${t}`,s=e.getCache(n);if(!s){let i=r(c),a=r(t);s=`${i} ${a}`,e.setCache(n,s)}return s}}},f=e=>({applyFocalPoint:o=>{if(o.getAttribute(l.attr.processed)==="true")return;let c=o.getAttribute(l.attr.focalX),t=o.getAttribute(l.attr.focalY);if(c===null||t===null)return;let n=e.calculatePosition(c,t);d(()=>({image:o,position:n}),a=>{a.image.style.objectPosition=a.position,a.image.style.opacity="1",a.image.setAttribute(l.attr.processed,"true")})}}),h=()=>{let e=m(),r=()=>{if(!e.init())return null;let c=g(e),t=f(c);return e.get("images").forEach(s=>{t.applyFocalPoint(s)}),o},o=()=>{e?.cleanup()};return{init:r}},b=()=>{let e=p(),o=h().init();o&&e.register("FocalImageAPI",o)};b();})();
