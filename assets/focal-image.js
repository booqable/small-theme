import{frameSequence as t,cleanupSystem as e}from"utils.js";const n={t:{image:".focal-image"},o:{l:"data-focal-x",i:"data-focal-y",u:"data-focal-processed"},m:"50% 50%"},a=()=>{const t=new Map,e=new Map;return{init:()=>{const e=document.querySelectorAll(n.t.image);return t.set("images",Array.from(e)),t.get("images").length>0},get:e=>t.get(e),p:t=>e.get(t),$:(t,n)=>{e.set(t,n)},h:()=>{t.clear(),e.clear()}}},o=t=>{const e=t=>{const e=50*((parseFloat(t)||0)+1);return`${Math.max(0,Math.min(100,e))}%`};return{M:(a,o)=>{if(null===a||null===o)return n.m;const r=`${a}_${o}`;let c=t.p(r);return c||(c=`${e(a)} ${e(o)}`,t.$(r,c)),c}}},r=e=>({P:a=>{if("true"===a.getAttribute(n.o.u))return;const o=a.getAttribute(n.o.l),r=a.getAttribute(n.o.i);if(null===o||null===r)return;const c=e.M(o,r);t(()=>({image:a,position:c}),t=>{t.image.style.objectPosition=t.position,t.image.style.opacity="1",t.image.setAttribute(n.o.u,"true")})}}),c=()=>{const t=a(),e=()=>{t?.h()};return{init:()=>{if(!t.init())return null;const n=o(t),a=r(n);return t.get("images").forEach(t=>{a.P(t)}),e}}},l=()=>{const t=e(),n=c().init();n&&t.register("FocalImageAPI",n)};l();