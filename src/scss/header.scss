// Import variables
@use 'variables' as *;

// Import mixins
@use '_helpers/mixins' as *;

// Import components
@use '_components/menu' as *;
@use '_components/search' as *;

.header {
  --header-background: transparent;
  --header-border-color: #{$color-border};
  --header-btn-display: none;
  --header-content-areas: 'logo icons menu';
  --header-content-columns: 1fr auto auto;
  --header-content-gap: 8px;
  --header-logo-visibility: 1;
  --header-logo-floated-visibility: 0;
  --header-menu-row: 2;
  --header-position: static;
  --header-position-top: var(--preview-height, 0);
  --header-transition-duration: #{$transition-duration};
  --header-transition-delay: #{$transition-duration};

  z-index: 1;
  position: var(--header-position);
  top: var(--header-position-top);
  left: 0;
  right: 0;

  @include media-up(md) {
    --header-btn-display: block;
  }

  &__inner {
    --header-menu-bottom-padding: 0;
    --header-menu-indent: var(--menu-indent-mobile);
    --header-padding-bottom: var(--padding-bottom-mobile, 12px);
    --header-padding-top: var(--padding-top-mobile, 12px);

    color: $color-primary;
    background: var(--header-background);
    border-bottom: 1px solid var(--header-border-color);
    transition: background var(--header-transition-duration) var(--header-transition-delay) $transition-function,
      border var(--header-transition-duration) var(--header-transition-delay) $transition-function,
      padding $transition-duration $transition-function;

    @include media-up(md) {
      --header-menu-bottom-padding: var(--menu-bottom-padding-top-desktop);
      --header-menu-bottom-border-top-width: var(--menu-bottom-border-top-width-desktop, 100%);
      --header-menu-indent: var(--menu-indent-desktop);
      --header-padding-bottom: var(--padding-bottom-desktop, 12px);
      --header-padding-top: var(--padding-top-desktop, 12px);
    }

    &--padding-top {
      padding-top: var(--header-padding-top);
    }

    &--padding-bottom {
      padding-bottom: var(--header-padding-bottom);
    }

    &--background {
      background: $background-primary;
    }
  }

  &__content {
    display: grid;
    justify-content: space-between;
    align-items: stretch;
    grid-template-areas: var(--header-content-areas);
    grid-template-columns: var(--header-content-columns);

    [style*="--menu-opener-position: left"] & {
      --header-content-areas: 'menu logo icons';
      --header-content-columns: auto 1fr auto;
    }

    @include media-up(md) {
      --header-content-areas: 'logo icons'
                              'menu menu';
      --header-content-columns: 1fr auto;

      grid-template-rows: auto auto;

      [style*="--menu-vertical-alignment: top"] & {
        --header-content-areas: 'logo menu icons';
        --header-content-columns: 220px 1fr 220px;
      }
    }

    &--outlined {
      @include media-up(md) {
        border: 1px solid $color-border;
        border-radius: $border-radius;
        padding: var(--header-padding-top) var(--header-padding-bottom) var(--header-padding-bottom);
        margin: calc(-1 * var(--header-padding-top)) 0 calc(-1 * var(--header-padding-bottom));
      }
    }
  }

  &__menu {
    margin: var(--header-menu-indent);
    grid-area: menu;

    @include media-up(md) {
      position: relative;
      padding: var(--header-menu-bottom-padding);
      grid-row: var(--header-menu-row);

      [style*="--menu-vertical-alignment: top"] & {
        --header-menu-row: 1;
      }
    }

    &::before {
      @include media-up(md) {
        content: "";
        display: block;
        width: calc(var(--header-menu-bottom-border-top-width));
        height: var(--menu-border-width-desktop, 1px);
        margin: 0;
        position: absolute;
        left: 50%;
        top: 0;
        transform: translateX(-50%);
        background: $color-border;
      }
    }
  }

  &__logo {
    padding-right: 16px;
    grid-area: logo;

    &-image {
      &-holder {
        transition: opacity var(--header-transition-duration) var(--header-transition-delay) $transition-function;

        &--floated {
          opacity: var(--header-logo-floated-visibility);
        }

        &:not(&--floated) {
          opacity: var(--header-logo-visibility);
        }
      }
    }
  }

  &__btn {
    &-wrapper {
      display: var(--header-btn-display);
    }
  }

  &__icons {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    gap: var(--header-content-gap);
    grid-area: icons;
  }

  &:has(.header__inner--sticky) {
    --header-position: sticky;
  }

  &:has(.header__content--outlined) {
    --header-border-color: transparent;
  }

  &:not(&:has(.header__inner--background)) {
    --header-border-color: transparent;
    --header-position: absolute;
    --header-position-top: 0;

    .header__logo-image-holder {
      &--floated {
        --header-logo-floated-visibility: 1;
      }

      &:not(&--floated) {
        --header-logo-visibility: 0;

        &:only-child {
          --header-logo-visibility: 1;
        }
      }
    }

    &:has(.header__inner--sticky) {
      --header-position: fixed;
    }
  }

  &:has(.menu__item.has-dropdown.active),
  &:has(.menu__item.has-dropdown:hover),
  &:has(#header-opener-menu:checked),
  &:has(#header-opener-search:checked){
    --header-border-color: #{$color-border};
    --header-transition-duration: 0s;
    --header-transition-delay: 0s;

    .header__inner {
      --header-background: #{$background-primary};
      --header-transition-duration: 0s;
      --header-transition-delay: 0s;

      .header__logo-image-holder {
        &--floated {
          --header-logo-floated-visibility: 0;
        }

        &:not(&--floated) {
          --header-logo-visibility: 1;
        }
      }
    }

    /* stylelint-disable-next-line */
    &:has(.header__content--outlined) {
      @include media-up(md) {
        --header-border-color: transparent;
      }
    }
  }
}
